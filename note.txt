 add new subdomain
  maindoamin->manageNameServer->pengelolaanDns->addNewRecord->Record Type = a ip base on ip current ip
swagger
  https://medium.com/@tatianaensslin/how-to-add-swagger-ui-to-php-server-code-f1610c01dc03
 composer update update vendor

 php spark migrate genarate table
 php spark migrate:rollback remove table
 php spark db:seed RunSeeder insert table

 php spark make:scaffold acc_account_name --restful --return entity
 php spark serve

 https://onlinewebtutorblog.com/how-to-enable-cors-in-codeigniter-4-for-rest-apis/

 * template 
    - subject
    - class
    - privilage
    - room
    - student
    - exam

SELECT 
       s.id, s.name,s.classId , e.subjectId, sb.name , sum(if(e.answer= re.choise,e.point,0)) point
FROM 
        resultexams re 
    JOIN exams e on e.id = re.examId 
    JOIN students s on s.id = re.studentId
    JOIN subjects sb on sb.id = e.subjectId
 where s.id = 2
 and  re.createdAt BETWEEN '2022-05-07 00:00:00' AND '2022-05-07 23:59:59' 
  
GROUP by s.id,  e.subjectId;


SELECT 
  s.id, s.name,s.classId,c.name className ,r.name roomName,d.name departmentName, e.subjectId, sb.name , sum(if(e.answer= re.choise,e.point,0)) point
FROM 
resultexams re 
JOIN students s on s.id = re.studentId
JOIN exams e on e.id = re.examId and e.classId = s.classId
JOIN subjects sb on sb.id = e.subjectId
JOIN rooms r on r.id = s.roomId
JOIN departments d on d.id = r.departmentId
JOIN classes c on c.id = s.classId
where re.createdAt BETWEEN '2022-05-07 00:00:00' AND '2022-05-07 23:59:59' and e.classId = 2
and r.departmentId = 1 
and r.id = 1
GROUP by s.id,e.subjectId;

SELECT  s.id, s.name,s.classId,c.name className ,r.name roomName,d.name departmentName, e.subjectId, sb.name , sum(if(e.answer= re.choise,e.point,0)) point
FROM 
resultexams re 
JOIN students s on s.id = re.studentId
JOIN exams e on e.id = re.examId and e.classId = s.classId
JOIN subjects sb on sb.id = e.subjectId
JOIN rooms r on r.id = s.roomId
JOIN departments d on d.id = r.departmentId
JOIN classes c on c.id = s.classId
where re.createdAt BETWEEN '2022-05-07 00:00:00' AND '2022-05-07 23:59:59'   
and s.roomId = 1
and s.classId = 1
GROUP by s.id,e.subjectId;


SELECT `s`.`id`, `s`.`name`, `s`.`classId`, `c`.`name` `className`, `r`.`name` `roomName`, `d`.`name` `departmentName`, `e`.`subjectId`, `sb`.`name`, sum(if(e.answer= resultexams.choise, `e`.`point`, 0)) point
FROM `resultexams`
JOIN `students` `s` ON `s`.`id` = `resultexams`.`studentId`
JOIN `exams` `e` ON `e`.`id` = `resultexams`.`examId` and `e`.`classId` = `s`.`classId`
JOIN `subjects` `sb` ON `sb`.`id` = `e`.`subjectId`
JOIN `rooms` `r` ON `r`.`id` = `s`.`roomId`
JOIN `departments` `d` ON `d`.`id` = `r`.`departmentId`
JOIN `classes` `c` ON `c`.`id` = `s`.`classId`
WHERE `resultexams`.`createdAt` BETWEEN "2022-05-07 00:00:00" and "2022-05-07 23:59:59"
AND `s`.`roomId` = '7'
AND `s`.`classId` = '3'
GROUP BY `s`.`id`, `e`.`subjectId`

https://codeigniter4.github.io/userguide/libraries/time.html

https://localhost.com/api/Students/countGender
{
  "groupBy":"gender,classId,roomId"
}

SELECT t.name, s.name,c.name, st.duration FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
where t.id = 4;

total duration
SELECT t.name, sum( st.duration) duration FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
GROUP BY t.id;


SELECT t.name, sum( st.duration) , IFNULL(hr.duration,0) duration FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
LEFT JOIN hoomrooms hr on hr.teacherId = t.id 
GROUP by t.id;

duration homeroom subjet
SELECT t.name, sum( st.duration) durationsubject, sum(IFNULL(hr.duration,0)) durationhoomrom,(sum( st.duration)+IFNULL(hr.duration,0) ) total FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
LEFT JOIN hoomrooms hr on hr.teacherId = t.id 
GROUP by t.id;

SELECT t.id, t.name, sum( st.duration) durationsubject,sum( tt.duration) durationtask,  sum(IFNULL(hr.duration,0)) durationhoomrom,(sum( st.duration)+IFNULL(hr.duration,0) ) total FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
LEFT JOIN hoomrooms hr on hr.teacherId = t.id 
RIGHT JOIN teachertasks tt on tt.teacherId = t.id 
JOIN tasks ta on ta.id = tt.taskId
GROUP by t.id
ORDER BY t.id;

SELECT t.id, t.name, 
sum( st.duration) durationsubject,
sum( tt.duration) durationtask,  
sum(IFNULL(hr.duration,0)) durationhoomrom,
sum( st.duration)+IFNULL(hr.duration,0)+sum( tt.duration)  total 
FROM `subjectteachers` st
JOIN teachers t on t.id = st.teacherId
JOIN subjects s on s.id = st.subjectId
JOIN classes c on c.id = st.classId
LEFT JOIN hoomrooms hr on hr.teacherId = t.id 
LEFT JOIN teachertasks tt on tt.teacherId = t.id 
JOIN tasks ta on ta.id = tt.taskId
GROUP by t.id
ORDER BY t.id;

SELECT t.id,  t.name,sum(ifnull(tt.duration, 0)) as task  ,sum(ifnull(st.duration, 0)) as subject, sum(IFNULL(hr.duration,0)) as hoomroom , 
(sum(ifnull(tt.duration, 0))+sum(ifnull(st.duration, 0))+sum(IFNULL(hr.duration,0))) duration
FROM teachertasks tt
JOIN teachers t on t.id = tt.teacherId
left JOIN subjectteachers st on t.id = st.teacherId
LEFT JOIN hoomrooms hr on hr.teacherId = t.id 
group by t.id order by t.id;
 
SELECT t.id,t.name, ifnull(tt.teachertasks,0) teachertasks,ifnull(hr.hoomrooms,0)hoomrooms,ifnull(st.subjectteachers,0)subjectteachers , (ifnull(tt.teachertasks,0)+ifnull(hr.hoomrooms,0)+ifnull(st.subjectteachers,0) ) total FROM teachers t
 JOIN 
(SELECT t.id,t.name, sum(ifnull(tt.duration, 0)) as teachertasks from 
 teachers t
 JOIN teachertasks tt
 on t.id = tt.teacherId group by t.id ) tt on tt.id = t.id
 LEFT JOIN 
(SELECT t.id,t.name, sum(ifnull(hr.duration, 0)) as hoomrooms from 
 teachers t
  JOIN  hoomrooms hr
 on t.id = hr.teacherId group by t.id  ) hr on hr.id = t.id
 LEFT JOIN 
  (SELECT t.id,t.name,sum(ifnull(st.duration, 0)) as subjectteachers from 
 teachers t
  JOIN  subjectteachers st
 on t.id = st.teacherId group by t.id ) st on st.id = t.id  
ORDER BY `t`.`id` ASC;